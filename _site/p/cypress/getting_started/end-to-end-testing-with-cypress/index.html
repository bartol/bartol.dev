<p>&quot;What is End to End or E2E testing?&quot;, you may ask. It sounds fairly complicated. Don't judge a book by its cover. It is basically robot that opens browser and runs tests on website.</p>
<p>And <a href="https://www.cypress.io/">Cypress</a> is just that robot. It's built with <a href="https://electronjs.org/">Electron</a> and it uses <a href="https://mochajs.org/">Mocha</a> testing framework and <a href="https://www.chromium.org/">Chromium</a> to run tests.</p>
<p>End to End tests are very effective because they provide great testing value and are easy to setup.</p>
<h2>Cypress setup</h2>
<p>Let's start with installing Cypress as dev dependency.</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">yarn</span> <span class="token function">add</span> -D cypress</span></code></pre>
<p>While Cypress is installing add <code>cy:open</code> to list of scripts in your projects's <code>package.json</code>.</p>
<pre class="language-json"><code class="language-json"><span class="highlight-line">...</span><br><span class="highlight-line"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  ...</span><br><span class="highlight-line">  <span class="token property">"cy:open"</span><span class="token operator">:</span> <span class="token string">"cypress open"</span></span><br><span class="highlight-line">  ...</span><br><span class="highlight-line"><span class="token punctuation">}</span></span><br><span class="highlight-line">...</span></code></pre>
<p>To start it you need is to run script that we added in previous step.</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">yarn</span> cy:open</span></code></pre>
<p>Then click &quot;Ok, got it&quot; and &quot;Run all specs&quot; in top right.</p>
<p>Cypress cool demo will start. You can watch it.</p>
<p>Next thing we'll have to do is make our own tests. This process will start with configuration. This is decent starting config you can copy to your <code>cypress.json</code> in root directory of your project.</p>
<pre class="language-json"><code class="language-json"><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">"baseUrl"</span><span class="token operator">:</span> <span class="token string">"http://localhost:8000"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token property">"integrationFolder"</span><span class="token operator">:</span> <span class="token string">"cypress/e2e"</span> <span class="token comment">// optional</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>There are few more optional <em>cleanup things to do.</em></p>
<ol>
<li>Open cypress folder.</li>
<li>If you changed integration folder in config, delete <code>integration</code> and make new folder with name you specified in Cypress config.</li>
<li>Delete <code>fixtures</code> and <code>screenshots</code> folders. We won't need them.</li>
<li>If you enabled &quot;<a href="https://eslint.org/docs/rules/no-unused-vars#argsignorepattern">argsIgnorePattern</a>&quot; feature of ESLint, open <code>index.js</code> in plugins directory and add underscore to start of params so ESLint doesn't complain. (like this <code>... (_firstparam, _secondparam) {...</code> )</li>
</ol>
<p>Let's do some testing already!</p>
<h2>Actual testing</h2>
<p>But wait! You first need to first install <a href="https://www.npmjs.com/package/@testing-library/cypress">cypress testing library</a>.</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">yarn</span> <span class="token function">add</span> -D @testing-library/cypress</span></code></pre>
<p>Then import it in <code>cypress/support/commands.js</code> file.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> <span class="token string">'@testing-library/cypress/add-commands'</span></span></code></pre>
<p>Now we are ready for testing. We will make one smoke test as an example.</p>
<p>What? Smoke test??? <a href="https://en.wikipedia.org/wiki/Smoke_testing_(software)">You can read more about it here.</a></p>
<p>TLDR: high level overview if everything is working alright.</p>
<p>Create <code>smoke.js</code> in your <code>cypress/integration/</code> folder (or custom one if you specified it in config), populate it with following snippet and tweak for you website.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'works'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    cy<span class="token punctuation">.</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span></span><br><span class="highlight-line">      <span class="token punctuation">.</span><span class="token function">getByText</span><span class="token punctuation">(</span><span class="token regex">/Undo last Git commit/i</span><span class="token punctuation">)</span></span><br><span class="highlight-line">      <span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><br><span class="highlight-line">      <span class="token punctuation">.</span><span class="token function">getByText</span><span class="token punctuation">(</span><span class="token regex">/git push origin -f/i</span><span class="token punctuation">)</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span></code></pre>
<p>This will open your website and click element with text &quot;Undo last Git commit&quot; (regex will match every every casing of words). It will throw an error if it cant find &quot;git push origin -f&quot; text after click.</p>
<p>Now you can run your tests with <code>cy:open</code> and see them passing, or failing ☹️.</p>
<p>If ESLint is throwing errors in your Cypress test file read <a href="https://bartol.dev/fix-cypress-tests-eslint-errors">this</a> article...</p>
