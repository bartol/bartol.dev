<p>Ah, month ago I created 2 posts about CRUD functions (create and read) in DynamoDB and rest were left collecting dust in to-do list. Figured out I should get to it and cross it off as soon as possible. Anyways, lets see how you can delete item from DynamoDB table. First thing you should always do when working with DynamoDB and Lambda is provide permission to access it.</p>
<pre class="language-yaml"><code class="language-yaml"><span class="highlight-line"><span class="token comment"># serverless.yml</span></span><br><span class="highlight-line"><span class="token comment"># ...</span></span><br><span class="highlight-line"><span class="token key atrule">provider</span><span class="token punctuation">:</span></span><br><span class="highlight-line">  <span class="token comment"># ...</span></span><br><span class="highlight-line">  <span class="token key atrule">iamRoleStatements</span><span class="token punctuation">:</span></span><br><span class="highlight-line">    <span class="token punctuation">-</span> <span class="token key atrule">Effect</span><span class="token punctuation">:</span> Allow</span><br><span class="highlight-line">      <span class="token key atrule">Action</span><span class="token punctuation">:</span></span><br><span class="highlight-line">        <span class="token punctuation">-</span> dynamodb<span class="token punctuation">:</span>DeleteItem</span><br><span class="highlight-line">      <span class="token key atrule">Resource</span><span class="token punctuation">:</span> <span class="token string">'arn:aws:dynamodb:us-east-1:111111111:table/tableName'</span></span></code></pre>
<p>Now you can open function handler and import AWS SDK...</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">const</span> <span class="token constant">AWS</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'aws-sdk'</span><span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token comment">// or if you're using ES6</span></span><br><span class="highlight-line"><span class="token keyword">import</span> <span class="token constant">AWS</span> <span class="token keyword">from</span> <span class="token string">'aws-sdk'</span></span></code></pre>
<p>...and initialize DynamoDB client which will provide methods like <code>delete</code> to manipulate items and tables.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">const</span> docClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AWS<span class="token punctuation">.</span>DynamoDB<span class="token punctuation">.</span>DocumentClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></code></pre>
<p>Here comes the fun part. You'll need to create object that will contain name of table and key of item that will deleted. Then call document client <code>delete</code> method passing previously created object in try/catch block.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  TableName<span class="token punctuation">:</span> tableName<span class="token punctuation">,</span></span><br><span class="highlight-line">  Key<span class="token punctuation">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    id<span class="token punctuation">:</span> <span class="token string">'value'</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">try</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token keyword">await</span> docClient<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
