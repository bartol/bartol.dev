<p>First a little bit of backstory. About one month ago I was working on fetching top posts from this blog from Google Analytics and I encountered this pretty cryptic error.</p>
<p><img src="./error.png" alt="Error in netlify console"></p>
<p>Everything was working perfectly on local environment but on Travis CI and Netlify it was failing. After reading countless Stack Overflow questions and copy-pasting my API keys multiple times I stumbled on <a href="https://github.com/googleapis/google-api-nodejs-client/issues/1110#issuecomment-436868760">this</a> issue comment.</p>
<p>The problem was that Netlify and Travis CI were escaping <code>\</code> in newline characters so they would look like this <code>\\n</code>.</p>
<h2>Solution</h2>
<p>Add this to your code.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">const</span> replace <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash.replace'</span><span class="token punctuation">)</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> apiKey <span class="token operator">=</span> <span class="token function">replace</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">YOUR_API_KEY</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'\\\\n'</span><span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span></span></code></pre>
<p>Make sure to install lodash replace module.</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">yarn</span> <span class="token function">add</span> lodash.replace</span></code></pre>
<p>And don't forget to use your &quot;escaped&quot; key instead of original one for authentication.</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token function">someCoolServiceThatNeedsApiKey</span><span class="token punctuation">(</span></span><br><span class="highlight-line">  apiKey</span><br><span class="highlight-line">  <span class="token comment">// ...</span></span><br><span class="highlight-line"><span class="token punctuation">)</span></span></code></pre>
