<p>Before jumping into program solving and coding I have to set up environment. This includes serverless config, typescript and similar.</p>
<h2>Yarn</h2>
<p>For managing packages I chose to use <a href="https://yarnpkg.com/lang/en/">Yarn</a>, without any special configuration.</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">yarn</span> init -y</span></code></pre>
<p>For TypeScript support, I'll need <code>serverless-plugin-typescript</code> and <code>typescript</code> as dev dependencies.</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">yarn</span> <span class="token function">add</span> -D serverless-plugin-typescript typescript</span></code></pre>
<h2>Serverless Framework</h2>
<p>Serverless framework will help manage AWS resources. Much better than zipping and uploading code to Lambda Dashboard on every change.</p>
<pre class="language-yaml"><code class="language-yaml"><span class="highlight-line"><span class="token comment"># serverless.yml</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token key atrule">service</span><span class="token punctuation">:</span> social<span class="token punctuation">-</span>images</span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token key atrule">plugins</span><span class="token punctuation">:</span></span><br><span class="highlight-line">  <span class="token punctuation">-</span> serverless<span class="token punctuation">-</span>plugin<span class="token punctuation">-</span>typescript</span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token key atrule">provider</span><span class="token punctuation">:</span></span><br><span class="highlight-line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> aws</span><br><span class="highlight-line">  <span class="token key atrule">runtime</span><span class="token punctuation">:</span> nodejs8.10</span><br><span class="highlight-line">  <span class="token key atrule">stage</span><span class="token punctuation">:</span> dev</span><br><span class="highlight-line">  <span class="token key atrule">region</span><span class="token punctuation">:</span> us<span class="token punctuation">-</span>east<span class="token punctuation">-</span><span class="token number">1</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token key atrule">functions</span><span class="token punctuation">:</span></span><br><span class="highlight-line">  <span class="token key atrule">generate</span><span class="token punctuation">:</span></span><br><span class="highlight-line">    <span class="token key atrule">handler</span><span class="token punctuation">:</span> handler.handler</span><br><span class="highlight-line">    <span class="token key atrule">events</span><span class="token punctuation">:</span></span><br><span class="highlight-line">      <span class="token punctuation">-</span> <span class="token key atrule">http</span><span class="token punctuation">:</span></span><br><span class="highlight-line">          <span class="token key atrule">path</span><span class="token punctuation">:</span> /</span><br><span class="highlight-line">          <span class="token key atrule">method</span><span class="token punctuation">:</span> GET</span></code></pre>
<h2>TypeScript</h2>
<p>Just the most basic configuration I found in serverless plugin docs.</p>
<pre class="language-json"><code class="language-json"><span class="highlight-line"><span class="token comment">//  tsconfig.json</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token property">"preserveConstEnums"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token property">"strictNullChecks"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token property">"esModuleInterop"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token property">"sourceMap"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token property">"allowJs"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"es5"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token property">"outDir"</span><span class="token operator">:</span> <span class="token string">".build"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token property">"moduleResolution"</span><span class="token operator">:</span> <span class="token string">"node"</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token property">"lib"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"es2015"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    <span class="token property">"rootDir"</span><span class="token operator">:</span> <span class="token string">"./"</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<h2>Handler</h2>
<p>Last thing for today will be function handler. It won't do anything for now.</p>
<pre class="language-typescript"><code class="language-typescript"><span class="highlight-line"><span class="token comment">// handler.ts</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    statusCode<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span></span><br><span class="highlight-line">    body<span class="token punctuation">:</span> <span class="token string">'hey'</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
